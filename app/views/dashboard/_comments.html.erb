<div class="container" style="width: 100%">
<table id="comments" class="table table-striped" style="width: inherit">
  <thead>
    <tr>
      <th>Content</th>
      <th>User</th>
      <th>Store</th>
      <th>Edit | Delete</th>
    </tr>
  </thead>
  <tbody>
  	<% @comments = Comment.all %>
    <% @comments.each do |comment| %>
    <% commentUser = User.find(comment.user_id) %>
    <% store = Store.find(comment.store_id) %>
    <tr>
      <td><%= comment.content %></td>
      <td><%= commentUser.email %></td>
      <td><%= store.name %></td>
      <% if commentUser.id == current_user.id %>
      <td>
        <%= link_to(edit_comment_path(comment), 'data-target' => "#myCommentModal}",
  'data-toggle' => 'modal') do  %>
        <%= image_tag "editIcon.jpg", height: "50% !important", width: "40% !important", style: "max-height: 30px" %>
        <% end %>
        <div class="modal fade" id='<%= "myCommentModal" %>' tabindex="-1" role="dialog"
             aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel" align="left">Edit Comment</h4>
              </div>
              <% @comment = Comment.find(comment.id) %>
              <%= form_for @comment do |f| %>
              <div class="modal-body">
                <%= render partial: 'comments/edit', :locals => { f: f } %>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <%= f.submit "Save Comment", class: "btn btn-primary" %>
              </div>  
              <% end %>
            </div><!-- /.modal-content -->
          </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->
        <%= link_to(@comment, method: :delete, data: {confirm: 'Are you sure?'}) do  %>
        <%= image_tag "removeIcon.jpg", height: "50% !important", width: "40% !important", style: "max-height: 30px" %>
        <% end %>
      </td>
      <% else %>
      <td>
        <% if comment.created_at === comment.updated_at %>
        <strong>Created On: </strong>
        <%= comment.created_at.strftime("%b. %d, %Y") %>
        <% else %>
        <strong>Last Modified: </strong>
        <%= comment.updated_at.strftime("%b. %d, %Y") %>
        <% end %>
      </td>
      <% end %>
    </tr>
    <% end %>

  </tbody>

</table>
</div>
<script>
$(document).ready(function(){
    $('#comments').dataTable();
});
</script>
